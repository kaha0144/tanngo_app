<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .container { max-width: 800px; }
        .card { margin-bottom: 1.5rem; }
        .btn-full { width: 100%; margin-bottom: 0.5rem; }
        .resume-text { font-size: 0.9rem; color: #6c757d; }
    </style>
</head>
<body>
    <div class="container my-5">
        <div class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center mb-4">
            <h1 class="h2 mb-3 mb-md-0">å˜èªå­¦ç¿’ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h1>
            <div class="text-center text-md-end">
                <p class="me-md-3 mb-2 mb-md-0 d-block d-md-inline">ã‚ˆã†ã“ã, {{ current_user.nickname }} ã•ã‚“</p>
                <div class="btn-group" role="group">
                    <a href="{{ url_for('mypage') }}" class="btn btn-sm btn-outline-primary">ãƒã‚¤ãƒšãƒ¼ã‚¸</a>
                    {% if current_user.is_admin %}
                        <a href="{{ url_for('admin_page') }}" class="btn btn-sm btn-danger">ç®¡ç†è€…ãƒšãƒ¼ã‚¸</a>
                    {% endif %}
                    <a href="{{ url_for('logout') }}" class="btn btn-sm btn-outline-secondary">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
                </div>
            </div>
        </div>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-info">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-info">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">å‡ºé¡Œå½¢å¼ã‚’é¸æŠ</h5>
                <div class="btn-group w-100" role="group">
                    {% set current_direction = session.get('quiz_direction', 'ej') %}
                    <a href="{{ url_for('set_direction', direction='ej') }}" class="btn {% if current_direction == 'ej' %}btn-primary{% else %}btn-outline-primary{% endif %}">
                        è‹±èª â†’ æ—¥æœ¬èª
                    </a>
                    <a href="{{ url_for('set_direction', direction='je') }}" class="btn {% if current_direction == 'je' %}btn-primary{% else %}btn-outline-primary{% endif %}">
                        æ—¥æœ¬èª â†’ è‹±èª
                    </a>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-4">
                <!-- (ãƒ©ãƒ³ãƒ€ãƒ ã§å­¦ã¶ã‚«ãƒ¼ãƒ‰) -->
            </div>
            <!-- ... ä»–ã®ã‚«ãƒ¼ãƒ‰ ... -->
        </div>
        <div class="row">
            <div class="col-lg-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">ğŸš€ ãƒ©ãƒ³ãƒ€ãƒ ã§å­¦ã¶</h5>
                        <p class="card-text">å…¨ã¦ã®å˜èªã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«å‡ºé¡Œã•ã‚Œã¾ã™ã€‚</p>
                        <div class="mt-auto">
                            {% if saved_random_state %}
                                <p class="resume-text">ğŸ’¡ ä¸­æ–­ã—ãŸãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™</p>
                                <a href="{{ url_for('resume_random_quiz') }}" class="btn btn-success btn-full">é€”ä¸­ã‹ã‚‰å­¦ã¶</a>
                                <a href="{{ url_for('start_new_random_quiz') }}" class="btn btn-primary btn-full">æ–°ã—ãå­¦ã¶</a>
                            {% else %}
                                <a href="{{ url_for('start_new_random_quiz') }}" class="btn btn-primary btn-full">ã‚¯ã‚¤ã‚ºé–‹å§‹</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">ğŸ“š ç´°ã‹ãå­¦ã¶</h5>
                        <p class="card-text">ç¯„å›²ã‚’é¸ã‚“ã§é›†ä¸­çš„ã«å­¦ç¿’ã—ã¾ã™ã€‚</p>
                        <div class="mt-auto">
                            <a href="{{ url_for('learn_details') }}" class="btn btn-primary btn-full">ç¯„å›²ã‚’é¸æŠã™ã‚‹</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">ğŸ’ª é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’</h5>
                        <p class="card-text">é–“é•ãˆãŸå•é¡Œã«å†æŒ‘æˆ¦ã—ã¦è¨˜æ†¶ã‚’å®šç€ã€‚</p>
                        <div class="mt-auto">
                            {% if saved_review_state %}
                                <p class="resume-text">ğŸ’¡ ä¸­æ–­ã—ãŸãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™</p>
                                <a href="{{ url_for('retry_mistakes') }}" class="btn btn-success btn-full">é€”ä¸­ã‹ã‚‰å¾©ç¿’</a>
                            {% endif %}
                            <a href="{{ url_for('retry_mistakes') }}" class="btn btn-warning btn-full">
                                {% if saved_review_state %}æ–°ã—ãå¾©ç¿’ã‚’å§‹ã‚ã‚‹{% else %}å¾©ç¿’ã‚’é–‹å§‹{% endif %}
                            </a>
                            <a href="{{ url_for('manage_mistakes') }}" class="btn btn-outline-secondary btn-full mt-2">
                                é–“é•ã„ãƒªã‚¹ãƒˆã‚’ç®¡ç†
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">ğŸ† é€±é–“å­¦ç¿’ãƒ©ãƒ³ã‚­ãƒ³ã‚° Top 3</h5>
                {% if top_users %}
                    <ul class="list-group list-group-flush">
                        {% for user, attempts in top_users %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>
                                {% if loop.index == 1 %}ğŸ¥‡{% elif loop.index == 2 %}ğŸ¥ˆ{% elif loop.index == 3 %}ğŸ¥‰{% else %}{{ loop.index }}.{% endif %}
                                {{ user.nickname }} ã•ã‚“
                            </span>
                            <span class="badge bg-primary rounded-pill">{{ attempts }} å•</span>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted">ã¾ã ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                {% endif %}
            </div>
        </div>
        <!-- â˜…â˜…â˜… ã“ã“ã¾ã§ â˜…â˜…â˜… -->
        <!-- menu.html ã® <div class="row"> ã®ä¸­ã«è¿½åŠ  -->

        <div class="card mb-4">
            <div class="card h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">âš™ï¸ ãƒ„ãƒ¼ãƒ«ãƒ»åˆ†æ</h5>
                    <p class="card-text">ä¾¿åˆ©ãªæ©Ÿèƒ½ã§å­¦ç¿’ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚</p>
                    <div class="mt-auto">
                        <a href="{{ url_for('search_word') }}" class="btn btn-info btn-full">å˜èªã‚’æ¤œç´¢ã™ã‚‹</a>
                        <a href="{{ url_for('progress') }}" class="btn btn-info btn-full">é€²æ—ã‚°ãƒ©ãƒ•ã‚’è¦‹ã‚‹</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center mt-4">
            <a href="{{ url_for('start_fresh_quiz_from_anywhere') }}" class="btn btn-danger" onclick="return confirm('æœ¬å½“ã«å…¨ã¦ã®é€²è¡ŒçŠ¶æ³ã¨é–“é•ã„ãƒªã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ');">å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>